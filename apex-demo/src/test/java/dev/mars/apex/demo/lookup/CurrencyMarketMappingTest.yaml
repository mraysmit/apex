# Currency to Market Mapping Configuration
# Demonstrates YAML-based business logic instead of hardcoded switch statements
# Use Case: Map trading currencies to their primary stock exchanges/markets

# ============================================================================
# APEX YAML Configuration File
# ============================================================================
# Used by: CurrencyMarketMappingTest.java (Active test implementation)
# Purpose: Currency market mapping demonstration using APEX lookup enrichments
#          for currency data enrichment, market data lookups, and financial
#          instrument currency mapping with comprehensive market data
# Status: ACTIVE - Integrated with currency market mapping tests
# ============================================================================

metadata:
  id: "currency-to-market-mapping"
  name: "Currency to Market Mapping"
  version: "1.0.0"
  description: "Maps trading currencies to their primary stock exchanges using APEX YAML processing"
  type: "enrichment"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  tags: ["apex-demo", "lookup", "currency", "market"]

# Enrichment rules using verified APEX syntax
enrichments:
  - id: "currency-to-market-mapping"
    type: "lookup-enrichment"
    description: "Map currency to primary trading market/exchange"
    condition: "#currency != null && #currency.length() > 0"
    
    lookup-config:
      lookup-key: "#currency"
      lookup-dataset:
        type: "inline"
        key-field: "currency_code"
        data:
          # Major global currencies and their primary exchanges
          - currency_code: "USD"
            market: "NYSE"
            market_name: "New York Stock Exchange"
            region: "North America"
            timezone: "America/New_York"
            trading_hours: "09:30-16:00"
            
          - currency_code: "EUR"
            market: "XETRA"
            market_name: "XETRA Electronic Trading"
            region: "Europe"
            timezone: "Europe/Berlin"
            trading_hours: "09:00-17:30"
            
          - currency_code: "GBP"
            market: "LSE"
            market_name: "London Stock Exchange"
            region: "Europe"
            timezone: "Europe/London"
            trading_hours: "08:00-16:30"
            
          - currency_code: "CHF"
            market: "SIX"
            market_name: "SIX Swiss Exchange"
            region: "Europe"
            timezone: "Europe/Zurich"
            trading_hours: "09:00-17:30"
            
          - currency_code: "JPY"
            market: "TSE"
            market_name: "Tokyo Stock Exchange"
            region: "Asia Pacific"
            timezone: "Asia/Tokyo"
            trading_hours: "09:00-15:00"
            
          - currency_code: "HKD"
            market: "HKEX"
            market_name: "Hong Kong Stock Exchange"
            region: "Asia Pacific"
            timezone: "Asia/Hong_Kong"
            trading_hours: "09:30-16:00"
            
          - currency_code: "SGD"
            market: "SGX"
            market_name: "Singapore Exchange"
            region: "Asia Pacific"
            timezone: "Asia/Singapore"
            trading_hours: "09:00-17:00"
            
          - currency_code: "AUD"
            market: "ASX"
            market_name: "Australian Securities Exchange"
            region: "Asia Pacific"
            timezone: "Australia/Sydney"
            trading_hours: "10:00-16:00"
            
          - currency_code: "CAD"
            market: "TSX"
            market_name: "Toronto Stock Exchange"
            region: "North America"
            timezone: "America/Toronto"
            trading_hours: "09:30-16:00"
            
          - currency_code: "SEK"
            market: "OMX"
            market_name: "Nasdaq Stockholm"
            region: "Europe"
            timezone: "Europe/Stockholm"
            trading_hours: "09:00-17:30"
            
          - currency_code: "NOK"
            market: "OSE"
            market_name: "Oslo Stock Exchange"
            region: "Europe"
            timezone: "Europe/Oslo"
            trading_hours: "09:00-16:25"
            
          - currency_code: "DKK"
            market: "CSE"
            market_name: "Copenhagen Stock Exchange"
            region: "Europe"
            timezone: "Europe/Copenhagen"
            trading_hours: "09:00-17:00"
    
    # Map lookup results to enriched data fields
    field-mappings:
      - source-field: "market"
        target-field: "market"
        required: false
        
      - source-field: "market_name"
        target-field: "marketName"
        required: false
        
      - source-field: "region"
        target-field: "marketRegion"
        required: false
        
      - source-field: "timezone"
        target-field: "marketTimezone"
        required: false
        
      - source-field: "trading_hours"
        target-field: "tradingHours"
        required: false

# Processing configuration
processing:
  continue-on-error: true
  max-errors: 3
  error-handling: "log-and-continue"
  
  # Performance settings
  performance:
    enable-metrics: true
    enable-tracing: false
    log-slow-lookups: true
    slow-lookup-threshold-ms: 50
    
  # Retry configuration for lookup failures
  retry:
    enabled: true
    max-attempts: 2
    initial-delay-ms: 50
    max-delay-ms: 200
    backoff-multiplier: 2.0

# Monitoring and alerting
monitoring:
  metrics:
    enabled: true
    include-lookup-timing: true
    include-cache-stats: true
    
  alerts:
    enabled: false
    slow-lookup-threshold-ms: 100
    cache-miss-rate-threshold: 0.2
    error-rate-threshold: 0.05

