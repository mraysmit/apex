# Data Management Demo Configuration
# Real APEX YAML configuration for DataManagementDemo.java
# NO HARDCODED SIMULATION - Uses authentic APEX services

metadata:
  id: "data-management-demo-configuration"
  name: "Data Management Demo Configuration"
  version: "2.0.0"
  description: "Real APEX data management demonstration with dataset structure, enrichment, validation, and error handling"
  type: "rule-config"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  tags: ["apex-demo", "enrichment", "data-management"]

# Data Management Enrichments using proper APEX syntax
enrichments:
  # 1. Basic Dataset Structure Processing
  - id: "basic-dataset-structure-processing"
    name: "basic-dataset-structure-processing"
    type: "calculation-enrichment"
    description: "Basic dataset structure processing using real APEX services"
    condition: "#processingType == 'BASIC_DATASET'"
    calculation-config:
      expression: "#currency == 'USD' ? 'US Dollar' : (#currency == 'EUR' ? 'Euro' : (#currency == 'GBP' ? 'British Pound' : 'Unknown Currency'))"
      result-field: "currencyName"
    field-mappings:
      - source-field: "currencyName"
        target-field: "currencyName"

  # 2. Amount Validation Processing
  - id: "amount-validation-processing"
    name: "amount-validation-processing"
    type: "calculation-enrichment"
    description: "Amount validation for dataset structure"
    condition: "#processingType == 'BASIC_DATASET' && #amount != null && #amount > 0"
    calculation-config:
      expression: "true"
      result-field: "amountValid"
    field-mappings:
      - source-field: "amountValid"
        target-field: "amountValid"

  # 3. Customer Classification Processing
  - id: "customer-classification-processing"
    name: "customer-classification-processing"
    type: "calculation-enrichment"
    description: "Customer classification for dataset structure"
    condition: "#processingType == 'BASIC_DATASET' && #customerId != null"
    calculation-config:
      expression: "#customerId.startsWith('CUST') ? 'STANDARD_CUSTOMER' : 'UNKNOWN_CUSTOMER'"
      result-field: "customerType"
    field-mappings:
      - source-field: "customerType"
        target-field: "customerType"

  # 4. Product Lookup Processing
  - id: "product-lookup-processing"
    name: "product-lookup-processing"
    type: "calculation-enrichment"
    description: "Product lookup for simple enrichment"
    condition: "#processingType == 'SIMPLE_ENRICHMENT' && #productId != null"
    calculation-config:
      expression: "#productId == 'LAPTOP001' ? 'Business Laptop' : (#productId == 'DESKTOP001' ? 'Business Desktop' : 'Unknown Product')"
      result-field: "productName"
    field-mappings:
      - source-field: "productName"
        target-field: "productName"

  # 5. Quantity Validation Processing
  - id: "quantity-validation-processing"
    name: "quantity-validation-processing"
    type: "calculation-enrichment"
    description: "Quantity validation for simple enrichment"
    condition: "#processingType == 'SIMPLE_ENRICHMENT' && #quantity != null && #quantity > 0"
    calculation-config:
      expression: "true"
      result-field: "quantityValid"
    field-mappings:
      - source-field: "quantityValid"
        target-field: "quantityValid"

  # 6. Customer Status Processing
  - id: "customer-status-processing"
    name: "customer-status-processing"
    type: "calculation-enrichment"
    description: "Customer status enrichment for simple processing"
    condition: "#processingType == 'SIMPLE_ENRICHMENT' && #customerId != null"
    calculation-config:
      expression: "#customerId == 'CUST001' ? 'ACTIVE' : 'INACTIVE'"
      result-field: "customerStatus"
    field-mappings:
      - source-field: "customerStatus"
        target-field: "customerStatus"

  # 7. Data Management Summary Processing
  - id: "data-management-summary-processing"
    name: "data-management-summary-processing"
    type: "calculation-enrichment"
    description: "Data management processing summary"
    condition: "#processingType != null"
    calculation-config:
      expression: "'Data management processing completed for type: ' + #processingType + ' using real APEX services'"
      result-field: "dataManagementSummary"
    field-mappings:
      - source-field: "dataManagementSummary"
        target-field: "dataManagementSummary"

# Output configuration
output:
  include-input: true
  include-metadata: true
  format: "enhanced"

