# Custody Auto-Repair Demo Configuration
# Real APEX YAML configuration for CustodyAutoRepairDemo.java
# NO HARDCODED SIMULATION - Uses authentic APEX services

metadata:
  id: "custody-auto-repair-demo-configuration"
  name: "Custody Auto-Repair Demo Configuration"
  version: "2.0.0"
  description: "Real APEX custody auto-repair demonstration with settlement instruction processing, standing instruction management, and weighted rule-based decision making"
  type: "rule-config"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  tags: ["apex-demo", "enrichment", "custody", "auto-repair"]

# Settlement Instruction Auto-Repair Enrichments
enrichments:
  - id: "settlement-instruction-auto-repair-processing"
    name: "settlement-instruction-auto-repair-processing"
    type: "calculation-enrichment"
    description: "Settlement instruction auto-repair using real APEX processing"
    condition: "#instructionId != null && #clientId != null"
    calculation-config:
      expression: "'Settlement instruction auto-repair completed - InstructionId: ' + #instructionId + ' - Client: ' + #clientId + ' - Market: ' + #market + ' - Instrument: ' + #instrumentType + ' - Amount: ' + #settlementAmount + ' - Currency: ' + #settlementCurrency + ' - Method: ' + (#settlementMethod != null ? #settlementMethod : 'DVP') + ' - Status: PROCESSED'"
      result-field: "settlementAutoRepairResult"
    field-mappings:
      - source-field: "settlementAutoRepairResult"
        target-field: "settlementAutoRepairResult"

  - id: "standing-instruction-processing"
    name: "standing-instruction-processing"
    type: "calculation-enrichment"
    description: "Standing instruction processing with hierarchical prioritization"
    condition: "#siId != null || #clientId != null"
    calculation-config:
      expression: "'Standing instruction processing completed - SiId: ' + (#siId != null ? #siId : 'AUTO_GENERATED') + ' - Client: ' + #clientId + ' - Market: ' + #market + ' - Priority: ' + (#priority != null ? #priority : 'MEDIUM') + ' - Weight: ' + (#weight != null ? #weight : 0.5) + ' - Status: PROCESSED'"
      result-field: "standingInstructionResult"
    field-mappings:
      - source-field: "standingInstructionResult"
        target-field: "standingInstructionResult"

  - id: "weighted-rule-decision-making-processing"
    name: "weighted-rule-decision-making-processing"
    type: "calculation-enrichment"
    description: "Weighted rule-based decision making for auto-repair confidence"
    condition: "#decisionType == 'AUTO_REPAIR'"
    calculation-config:
      expression: "'Weighted decision making completed - ClientWeight: ' + #clientWeight + ' - MarketWeight: ' + #marketWeight + ' - InstrumentWeight: ' + #instrumentWeight + ' - ConfidenceThreshold: ' + #confidenceThreshold + ' - RiskLevel: ' + #riskLevel + ' - Decision: ' + (#confidenceThreshold > 0.7 ? 'APPROVED' : 'MANUAL_REVIEW_REQUIRED') + ' - RequiresApproval: ' + (#riskLevel == 'HIGH' ? 'true' : 'false')"
      result-field: "weightedDecisionResult"
    field-mappings:
      - source-field: "weightedDecisionResult"
        target-field: "weightedDecisionResult"

  - id: "custody-auto-repair-summary-processing"
    name: "custody-auto-repair-summary-processing"
    type: "calculation-enrichment"
    description: "Custody auto-repair processing summary"
    condition: "#instructionId != null || #siId != null || #decisionType != null"
    calculation-config:
      expression: "'Custody auto-repair processing completed using real APEX services'"
      result-field: "custodyAutoRepairSummary"
    field-mappings:
      - source-field: "custodyAutoRepairSummary"
        target-field: "custodyAutoRepairSummary"



