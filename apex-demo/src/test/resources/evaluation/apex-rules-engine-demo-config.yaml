# APEX Rules Engine Demo Configuration
# Real APEX YAML configuration for ApexRulesEngineDemo.java
# NO HARDCODED SIMULATION - Uses authentic APEX services

metadata:
  id: "apex-rules-engine-demo-configuration"
  name: "APEX Rules Engine Demo Configuration"
  version: "2.0.0"
  description: "Real APEX rules engine demonstration with investment validation, risk assessment, and compliance checking"
  type: "rule-config"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  tags: ["apex-demo", "evaluation", "rules-engine"]

# Investment Validation Enrichments
enrichments:
  - id: "investment-validation-enrichment"
    name: "investment-validation"
    type: "calculation-enrichment"
    description: "Validates investment scenarios using real APEX processing"
    condition: "#investmentAmount != null"
    calculation-config:
      expression: "#investmentAmount > 100000 ? 'HIGH_VALUE' : 'STANDARD'"
      result-field: "validationStatus"
    field-mappings:
      - source-field: "validationStatus"
        target-field: "validationStatus"

  - id: "approval-requirement-enrichment"
    name: "approval-requirement"
    type: "calculation-enrichment"
    description: "Determines approval requirement based on investment amount"
    condition: "#investmentAmount != null"
    calculation-config:
      expression: "#investmentAmount > 100000 ? 'true' : 'false'"
      result-field: "requiresApproval"
    field-mappings:
      - source-field: "requiresApproval"
        target-field: "requiresApproval"

  - id: "processing-path-enrichment"
    name: "processing-path"
    type: "calculation-enrichment"
    description: "Determines processing path based on customer risk profile"
    condition: "#customerRiskProfile != null"
    calculation-config:
      expression: "#customerRiskProfile == 'CONSERVATIVE' ? 'LOW_RISK' : (#customerRiskProfile == 'MODERATE' ? 'MEDIUM_RISK' : 'HIGH_RISK')"
      result-field: "processingPath"
    field-mappings:
      - source-field: "processingPath"
        target-field: "processingPath"

  - id: "risk-score-enrichment"
    name: "risk-score"
    type: "calculation-enrichment"
    description: "Calculates risk score based on customer age"
    condition: "#customerAge != null"
    calculation-config:
      expression: "#customerAge < 30 ? 85 : (#customerAge < 50 ? 70 : 55)"
      result-field: "riskScore"
    field-mappings:
      - source-field: "riskScore"
        target-field: "riskScore"

  - id: "experience-multiplier-enrichment"
    name: "experience-multiplier"
    type: "calculation-enrichment"
    description: "Calculates experience multiplier based on investment experience"
    condition: "#investmentExperience != null"
    calculation-config:
      expression: "#investmentExperience == 'EXPERIENCED' ? 1.2 : (#investmentExperience == 'INTERMEDIATE' ? 1.0 : 0.8)"
      result-field: "experienceMultiplier"
    field-mappings:
      - source-field: "experienceMultiplier"
        target-field: "experienceMultiplier"

  - id: "compliance-checking-enrichment"
    name: "compliance-checking"
    type: "calculation-enrichment"
    description: "Performs compliance checking using real APEX services"
    condition: "#investmentAmount != null"
    calculation-config:
      expression: "#investmentAmount > 250000 ? 'HIGH_COMPLIANCE' : 'STANDARD_COMPLIANCE'"
      result-field: "complianceLevel"
    field-mappings:
      - source-field: "complianceLevel"
        target-field: "complianceLevel"

  - id: "final-risk-rating-enrichment"
    name: "final-risk-rating"
    type: "calculation-enrichment"
    description: "Determines final risk rating based on risk tolerance"
    condition: "#riskTolerance != null"
    calculation-config:
      expression: "#riskTolerance == 'CONSERVATIVE' ? 'LOW' : (#riskTolerance == 'MODERATE' ? 'MEDIUM' : 'HIGH')"
      result-field: "finalRiskRating"
    field-mappings:
      - source-field: "finalRiskRating"
        target-field: "finalRiskRating"

  - id: "portfolio-recommendation-enrichment"
    name: "portfolio-recommendation"
    type: "calculation-enrichment"
    description: "Determines portfolio recommendation based on portfolio value"
    condition: "#portfolioValue != null"
    calculation-config:
      expression: "#portfolioValue > 1000000 ? 'PREMIUM_PORTFOLIO' : 'STANDARD_PORTFOLIO'"
      result-field: "portfolioRecommendation"
    field-mappings:
      - source-field: "portfolioRecommendation"
        target-field: "portfolioRecommendation"

# Rule Groups for Sequential Processing
rule-groups:
  - id: "apex-rules-engine-demo-configuration"
    name: "investment-processing-workflow"
    description: "Sequential investment processing workflow"
    rules:
      - name: "investment-validation"
        priority: 1
      - name: "risk-assessment"
        priority: 2
      - name: "compliance-checking"
        priority: 3

# Data Sources Configuration
data-sources:
  - name: "demo-data-source"
    type: "memory"
    description: "In-memory data source for demo scenarios"
    
# Lookup Services Configuration
lookup-services:
  - name: "investment-lookup"
    type: "memory-lookup"
    description: "Investment validation lookup service"
    
  - name: "risk-lookup"
    type: "memory-lookup"
    description: "Risk assessment lookup service"
    
  - name: "compliance-lookup"
    type: "memory-lookup"
    description: "Compliance checking lookup service"

# Processing Configuration
processing:
  fail-fast: true
  enable-logging: true
  max-processing-time: 30000
  
# Output Configuration
output:
  format: "json"
  include-metadata: true
  include-processing-time: true

