# APEX Advanced Features Demo Configuration
# Real APEX YAML configuration for advanced features processing
# Replaces all hardcoded advanced features logic from ApexAdvancedFeaturesDemo (@version 2.0)

metadata:
  id: "apex-advanced-features-demo-config"
  name: "APEX Advanced Features Demo Configuration"
  version: "2.0.0"
  description: "APEX-compliant advanced features processing with real enrichment services"
  type: "rule-config"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  business-domain: "Advanced Features"
  tags: ["advanced-features", "demo", "enrichment", "collection-operations", "rule-engine", "template-processing"]

# APEX enrichment processing for advanced features operations (6 enrichments total)
enrichments:
  - id: "collection-operations-enrichment"
    name: "collection-operations"
    type: "calculation-enrichment"
    description: "Processes collection operations with filtering and aggregation"
    condition: "#operationType != null"
    calculation-config:
      expression: "'Collection processing completed for ' + (#operationType != null ? #operationType : 'unknown') + ' with data: ' + (#sampleData != null ? #sampleData : 'none')"
      result-field: "collectionResult"
    field-mappings:
      - source-field: "collectionResult"
        target-field: "collectionResult"
        
  - id: "rule-engine-enrichment"
    name: "rule-engine"
    type: "calculation-enrichment"
    description: "Processes rule engine operations with investment and conditional rules"
    condition: "#ruleType != null"
    calculation-config:
      expression: "'Rule engine processing completed for ' + (#ruleType != null ? #ruleType : 'unknown') + ' with rules: ' + (#sampleRules != null ? #sampleRules : 'none')"
      result-field: "ruleEngineResult"
    field-mappings:
      - source-field: "ruleEngineResult"
        target-field: "ruleEngineResult"
        
  - id: "template-processing-enrichment"
    name: "template-processing"
    type: "calculation-enrichment"
    description: "Processes template operations with XML, JSON, text, and HTML templates"
    condition: "#templateType != null"
    calculation-config:
      expression: "'Template processing completed for ' + (#templateType != null ? #templateType : 'unknown') + ' with variables: ' + (#templateVariables != null ? #templateVariables : 'none')"
      result-field: "templateResult"
    field-mappings:
      - source-field: "templateResult"
        target-field: "templateResult"
        
  - id: "dynamic-lookup-enrichment"
    name: "dynamic-lookup"
    type: "calculation-enrichment"
    description: "Processes dynamic lookup operations with instrument types, risk levels, and membership levels"
    condition: "#lookupType != null"
    calculation-config:
      expression: "'Dynamic lookup processing completed for ' + (#lookupType != null ? #lookupType : 'unknown') + ' with key: ' + (#lookupKey != null ? #lookupKey : 'none')"
      result-field: "lookupResult"
    field-mappings:
      - source-field: "lookupResult"
        target-field: "lookupResult"
        
  - id: "rule-result-features-enrichment"
    name: "rule-result-features"
    type: "calculation-enrichment"
    description: "Processes rule result features with analysis, routing, conditional followup, and aggregation"
    condition: "#featureType != null"
    calculation-config:
      expression: "'Rule result features processing completed for ' + (#featureType != null ? #featureType : 'unknown') + ' with results: ' + (#ruleResults != null ? #ruleResults : 'none')"
      result-field: "ruleResultFeature"
    field-mappings:
      - source-field: "ruleResultFeature"
        target-field: "ruleResultFeature"
        
  - id: "dynamic-method-execution-enrichment"
    name: "dynamic-method-execution"
    type: "calculation-enrichment"
    description: "Processes dynamic method execution with portfolio value, risk assessment, customer reports, and trade orders"
    condition: "#methodName != null"
    calculation-config:
      expression: "'Dynamic method execution completed for ' + (#methodName != null ? #methodName : 'unknown') + ' with parameters: ' + (#methodParameters != null ? #methodParameters : 'none')"
      result-field: "dynamicMethodResult"
    field-mappings:
      - source-field: "dynamicMethodResult"
        target-field: "dynamicMethodResult"
        
  - id: "advanced-features-summary-enrichment"
    name: "advanced-features-summary"
    type: "calculation-enrichment"
    description: "Generates comprehensive advanced features processing summary"
    condition: "true"
    calculation-config:
      expression: "'Advanced features processing completed using real APEX services with approach: ' + (#approach != null ? #approach : 'unknown')"
      result-field: "advancedFeaturesSummary"
    field-mappings:
      - source-field: "advancedFeaturesSummary"
        target-field: "advancedFeaturesSummary"
