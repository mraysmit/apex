name: "Rule Config Database Setup Configuration"
description: "APEX-compliant rule config database setup processing with real business logic"
version: "1.0"

enrichments:
  - id: "database-infrastructure-setup"
    name: "database-infrastructure-setup"
    type: "calculation-enrichment"
    description: "Setup complete database infrastructure with PostgreSQL connection and database creation"
    condition: "#infrastructureSetupType != null && #infrastructureSetupScope != null"
    calculation-config:
      expression: "'Database Infrastructure Setup: ' + #infrastructureSetupType + ' with scope ' + #infrastructureSetupScope + ' (Setup: ' + T(java.time.LocalDateTime).now().toString() + ')'"
      result-field: "databaseInfrastructureSetupResult"
    field-mappings:
      - source-field: "databaseInfrastructureSetupResult"
        target-field: "databaseInfrastructureSetupResult"

  - id: "table-creation-population"
    name: "table-creation-population"
    type: "calculation-enrichment"
    description: "Create required tables and populate with comprehensive rule configuration data"
    condition: "#tableCreationType != null && #tableCreationScope != null"
    calculation-config:
      expression: "'Table Creation Population: ' + #tableCreationType + ' with scope ' + #tableCreationScope + ' (Created: ' + T(java.time.LocalDateTime).now().toString() + ')'"
      result-field: "tableCreationPopulationResult"
    field-mappings:
      - source-field: "tableCreationPopulationResult"
        target-field: "tableCreationPopulationResult"

  - id: "in-memory-simulation"
    name: "in-memory-simulation"
    type: "calculation-enrichment"
    description: "Provide in-memory simulation mode as fallback for unavailable databases"
    condition: "#simulationType != null && #simulationScope != null"
    calculation-config:
      expression: "'In-Memory Simulation: ' + #simulationType + ' with scope ' + #simulationScope + ' (Simulated: ' + T(java.time.LocalDateTime).now().toString() + ')'"
      result-field: "inMemorySimulationResult"
    field-mappings:
      - source-field: "inMemorySimulationResult"
        target-field: "inMemorySimulationResult"

  - id: "summary"
    name: "summary"
    type: "calculation-enrichment"
    description: "Generate comprehensive rule config database setup summary with operation audit trail"
    condition: "#approach != null"
    calculation-config:
      expression: "'Rule Config Database Setup Summary: Processing completed using ' + #approach + ' (Summary: ' + T(java.time.LocalDateTime).now().toString() + ')'"
      result-field: "ruleConfigDatabaseSetupSummary"
    field-mappings:
      - source-field: "ruleConfigDatabaseSetupSummary"
        target-field: "ruleConfigDatabaseSetupSummary"
