metadata:
  id: "field-basic-mappings-test"
  name: "Field Basic Mappings Test"
  version: "1.0.0"
  description: "Test basic field mapping and transformation operations"
  type: "rule-config"
  author: "apex-test-suite@example.com"
  created-date: "2025-09-14"
  tags: ["apex-test", "field-transformation", "field-mapping", "basic-operations"]

# Basic field mapping and transformation testing
enrichments:
  - id: "full-name-mapping"
    name: "full-name-mapping"
    type: "calculation-enrichment"
    description: "Map first and last name to full name with uppercase"
    condition: "#firstName != null && #lastName != null"
    calculation-config:
      expression: "(#firstName + ' ' + #lastName).toUpperCase()"
      result-field: "fullName"
    field-mappings:
      - source-field: "fullName"
        target-field: "fullName"

  - id: "email-normalization-mapping"
    name: "email-normalization-mapping"
    type: "calculation-enrichment"
    description: "Normalize email to lowercase"
    condition: "#email != null"
    calculation-config:
      expression: "#email.toLowerCase()"
      result-field: "normalizedEmail"
    field-mappings:
      - source-field: "normalizedEmail"
        target-field: "normalizedEmail"

  - id: "phone-formatting-mapping"
    name: "phone-formatting-mapping"
    type: "calculation-enrichment"
    description: "Format phone number with parentheses and dashes"
    condition: "#phoneNumber != null && #phoneNumber.length() == 10"
    calculation-config:
      expression: "'(' + #phoneNumber.substring(0, 3) + ') ' + #phoneNumber.substring(3, 6) + '-' + #phoneNumber.substring(6, 10)"
      result-field: "formattedPhone"
    field-mappings:
      - source-field: "formattedPhone"
        target-field: "formattedPhone"

  - id: "balance-category-mapping"
    name: "balance-category-mapping"
    type: "calculation-enrichment"
    description: "Map account balance to category"
    condition: "#accountBalance != null"
    calculation-config:
      expression: "#accountBalance >= 50000 ? 'HIGH' : (#accountBalance >= 10000 ? 'MEDIUM' : 'LOW')"
      result-field: "balanceCategory"
    field-mappings:
      - source-field: "balanceCategory"
        target-field: "balanceCategory"

  - id: "status-text-mapping"
    name: "status-text-mapping"
    type: "calculation-enrichment"
    description: "Map boolean status to text"
    condition: "#isActive != null"
    calculation-config:
      expression: "#isActive ? 'ACTIVE' : 'INACTIVE'"
      result-field: "statusText"
    field-mappings:
      - source-field: "statusText"
        target-field: "statusText"
