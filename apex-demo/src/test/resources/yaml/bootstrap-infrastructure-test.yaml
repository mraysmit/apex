metadata:
  name: "Bootstrap Document Infrastructure Setup Test"
  version: "1.0.0"
  description: "Test bootstrap document with complete infrastructure configuration"
  type: "bootstrap"
  id: "bootstrap-infrastructure-test"
  business-domain: "Infrastructure Management"
  created-by: "infrastructure.team@firm.com"
  created: "2025-09-14"
  last-modified: "2025-09-14"
  tags: ["test", "bootstrap", "infrastructure", "setup"]

bootstrap:
  infrastructure:
    # Database setup configuration
    database-setup:
      create-tables: true
      drop-existing: false
      create-indexes: true
      seed-data: true
      
      table-definitions:
        - name: "demo_trades"
          columns:
            - name: "id"
              type: "VARCHAR(50)"
              primary-key: true
            - name: "trade_date"
              type: "DATE"
              nullable: false
            - name: "counterparty"
              type: "VARCHAR(100)"
              nullable: false
            - name: "notional"
              type: "DECIMAL(15,2)"
              nullable: false
          
          indexes:
            - name: "idx_trade_date"
              columns: ["trade_date"]
            - name: "idx_counterparty"
              columns: ["counterparty"]
        
        - name: "demo_enrichments"
          columns:
            - name: "id"
              type: "VARCHAR(50)"
              primary-key: true
            - name: "enrichment_type"
              type: "VARCHAR(50)"
              nullable: false
            - name: "processing_time_ms"
              type: "INTEGER"
              nullable: false
      
      seed-data-files:
        - "infrastructure/seed-data/demo-trades.sql"
        - "infrastructure/seed-data/demo-enrichments.sql"

    # Performance monitoring configuration
    performance-monitoring:
      enabled: true
      real-time-metrics: true
      
      metrics:
        - name: "processing-time"
          type: "histogram"
          unit: "milliseconds"
          buckets: [1, 5, 10, 25, 50, 100, 250, 500, 1000]
        
        - name: "throughput"
          type: "counter"
          unit: "records-per-second"
        
        - name: "error-rate"
          type: "gauge"
          unit: "percentage"
        
        - name: "memory-usage"
          type: "gauge"
          unit: "megabytes"
      
      alerts:
        - metric: "processing-time"
          threshold: 100
          operator: "greater-than"
          action: "log-warning"
        
        - metric: "error-rate"
          threshold: 5.0
          operator: "greater-than"
          action: "send-notification"

    # Environment detection and setup
    environment-detection:
      auto-detect: true
      supported-environments: ["development", "test", "staging", "production"]
      
      environment-specific-config:
        development:
          database-url: "jdbc:h2:mem:dev_bootstrap"
          log-level: "DEBUG"
          performance-monitoring: false
        
        test:
          database-url: "jdbc:h2:mem:test_bootstrap"
          log-level: "INFO"
          performance-monitoring: true
        
        staging:
          database-url: "jdbc:postgresql://staging-db:5432/apex_bootstrap"
          log-level: "WARN"
          performance-monitoring: true
        
        production:
          database-url: "jdbc:postgresql://prod-db:5432/apex_bootstrap"
          log-level: "ERROR"
          performance-monitoring: true

  demo-scenarios:
    - scenario-id: "infrastructure-validation-demo"
      description: "Validates complete infrastructure setup and configuration"
      data-types: ["InfrastructureTest"]
      business-domain: "Infrastructure Management"
      enabled: true

data-sources:
  primary-database:
    type: "h2"
    url: "jdbc:h2:mem:bootstrap_infrastructure_test"
    username: "sa"
    password: ""
    
    connection-pool:
      initial-size: 2
      max-size: 10
      timeout: 5000
    
    health-check:
      enabled: true
      query: "SELECT 1"
      interval-seconds: 30
