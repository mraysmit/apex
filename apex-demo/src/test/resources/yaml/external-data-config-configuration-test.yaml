metadata:
  id: "external-data-config-configuration-test"
  name: "External Data Config Configuration Test"
  version: "1.0.0"
  description: "Test external-data-config document with comprehensive configuration settings"
  type: "external-data-config"
  author: "apex-test-suite@example.com"
  created-date: "2025-09-14"
  tags: ["apex-test", "external-data-config", "configuration"]

dataSources:
  - name: "test-database"
    type: "database"
    sourceType: "h2"
    enabled: true
    description: "Test database for configuration validation"
    
    connection:
      host: "localhost"
      port: 9092
      database: "test_db"
      username: "sa"
      password: ""
      
    queries:
      getTestRecord: "SELECT * FROM test_table WHERE id = :id"
      
  - name: "test-api"
    type: "rest-api"
    enabled: true
    description: "Test REST API for configuration validation"
    
    connection:
      baseUrl: "https://api.test.com/v1"
      timeout: 5000
      
    authentication:
      type: "api-key"
      keyHeader: "X-API-Key"
      keyValue: "${TEST_API_KEY}"
      
    endpoints:
      getTestData: "/test/{id}"

configuration:
  # Global connection settings
  defaultConnectionTimeout: 30000
  maxConnectionPoolSize: 50
  connectionValidationTimeout: 5000
  idleConnectionTimeout: 300000
  
  # Retry policy configuration
  retryPolicy:
    maxRetries: 3
    backoffStrategy: "exponential"
    initialDelayMs: 1000
    maxDelayMs: 10000
    retryableExceptions:
      - "java.net.SocketTimeoutException"
      - "java.net.ConnectException"
      - "java.io.IOException"
    nonRetryableExceptions:
      - "java.lang.SecurityException"
      - "java.lang.IllegalArgumentException"
      
  # Circuit breaker configuration
  circuitBreaker:
    enabled: true
    failureThreshold: 5
    recoveryTimeoutMs: 30000
    halfOpenMaxCalls: 3
    slowCallThresholdMs: 10000
    slowCallRateThreshold: 50
    
  # Monitoring and health check configuration
  monitoring:
    enabled: true
    healthCheckInterval: 60000
    healthCheckLogging: true
    performanceMetrics: true
    slowQueryThresholdMs: 5000
    errorThreshold: 10
    alertingEnabled: true
    
  # Cache configuration
  cache:
    globalEnabled: true
    globalTtlSeconds: 1800
    globalMaxSize: 100000
    evictionPolicy: "LRU"
    statisticsEnabled: true
    
  # Security configuration
  security:
    encryptionEnabled: true
    sslRequired: true
    certificateValidation: true
    allowSelfSignedCerts: false
    certificatePinning: false
    trustedCertificates:
      - "cert1.pem"
      - "cert2.pem"
      
  # Rate limiting configuration
  rateLimiting:
    globalEnabled: true
    defaultRequestsPerSecond: 100
    defaultBurstCapacity: 200
    windowSizeMs: 1000
    
  # Thread pool configuration
  threadPool:
    corePoolSize: 10
    maximumPoolSize: 50
    keepAliveTimeMs: 60000
    queueCapacity: 1000
    
  # Logging configuration
  logging:
    level: "INFO"
    requestLogging: true
    responseLogging: false
    errorLogging: true
    performanceLogging: true
    
  # Failover configuration
  failover:
    enabled: true
    maxFailoverAttempts: 2
    failoverDelayMs: 5000
    healthCheckBeforeFailover: true
    
  # Data validation configuration
  dataValidation:
    enabled: true
    strictMode: false
    validateSchema: true
    validateDataTypes: true
    allowNullValues: true
    
  # Compression configuration
  compression:
    enabled: true
    algorithm: "gzip"
    threshold: 1024
    
  # Metrics configuration
  metrics:
    enabled: true
    exportInterval: 60000
    includeJvmMetrics: true
    includeSystemMetrics: true
