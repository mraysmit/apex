metadata:
  id: "lookup-defaults-test"
  name: "Lookup Default Values Test"
  version: "1.0.0"
  description: "Test lookup operations with default values for missing keys"
  type: "rule-config"
  author: "apex-test-suite@example.com"
  created-date: "2025-09-14"
  tags: ["apex-test", "lookup-operations", "default-values", "missing-keys"]

# Lookup operations with default values testing
enrichments:
  - id: "currency-lookup-with-defaults"
    name: "currency-lookup-with-defaults"
    type: "lookup-enrichment"
    description: "Lookup currency with default values for unknown currencies"
    condition: "#knownCurrency != null"
    lookup-config:
      lookup-key: "#knownCurrency"
      lookup-dataset:
        type: "inline"
        key-field: "code"
        data:
          - code: "EUR"
            name: "Euro"
            symbol: "€"
            country: "European Union"
          - code: "GBP"
            name: "British Pound"
            symbol: "£"
            country: "United Kingdom"
        default-values:
          name: "Known Currency"
          symbol: "€"
          country: "Europe"
    field-mappings:
      - source-field: "name"
        target-field: "knownCurrencyName"
      - source-field: "symbol"
        target-field: "knownCurrencySymbol"
      - source-field: "country"
        target-field: "knownCurrencyCountry"

  - id: "unknown-currency-lookup"
    name: "unknown-currency-lookup"
    type: "lookup-enrichment"
    description: "Lookup unknown currency to test default values"
    condition: "#unknownCurrency != null"
    lookup-config:
      lookup-key: "#unknownCurrency"
      lookup-dataset:
        type: "inline"
        key-field: "code"
        data:
          - code: "EUR"
            name: "Euro"
            symbol: "€"
            country: "European Union"
          - code: "GBP"
            name: "British Pound"
            symbol: "£"
            country: "United Kingdom"
        default-values:
          name: "Unknown Currency"
          symbol: "?"
          country: "Unknown"
    field-mappings:
      - source-field: "name"
        target-field: "unknownCurrencyName"
      - source-field: "symbol"
        target-field: "unknownCurrencySymbol"
      - source-field: "country"
        target-field: "unknownCurrencyCountry"

  - id: "instrument-lookup-with-defaults"
    name: "instrument-lookup-with-defaults"
    type: "lookup-enrichment"
    description: "Lookup instrument with default values for unknown instruments"
    condition: "#knownInstrument != null"
    lookup-config:
      lookup-key: "#knownInstrument"
      lookup-dataset:
        type: "inline"
        key-field: "id"
        data:
          - id: "DE0001102309"
            type: "GOVERNMENT_BOND"
            maturity: "30Y"
            issuer: "GERMAN_GOVERNMENT"
          - id: "GB00B03MLX29"
            type: "GILT"
            maturity: "5Y"
            issuer: "UK_TREASURY"
        default-values:
          type: "KNOWN_INSTRUMENT"
          maturity: "UNKNOWN"
          issuer: "KNOWN_ISSUER"
    field-mappings:
      - source-field: "type"
        target-field: "knownInstrumentType"
      - source-field: "maturity"
        target-field: "knownInstrumentMaturity"
      - source-field: "issuer"
        target-field: "knownInstrumentIssuer"

  - id: "unknown-instrument-lookup"
    name: "unknown-instrument-lookup"
    type: "lookup-enrichment"
    description: "Lookup unknown instrument to test default values"
    condition: "#unknownInstrument != null"
    lookup-config:
      lookup-key: "#unknownInstrument"
      lookup-dataset:
        type: "inline"
        key-field: "id"
        data:
          - id: "DE0001102309"
            type: "GOVERNMENT_BOND"
            maturity: "30Y"
            issuer: "GERMAN_GOVERNMENT"
          - id: "GB00B03MLX29"
            type: "GILT"
            maturity: "5Y"
            issuer: "UK_TREASURY"
        default-values:
          type: "UNKNOWN_INSTRUMENT"
          maturity: "UNKNOWN"
          issuer: "UNKNOWN_ISSUER"
    field-mappings:
      - source-field: "type"
        target-field: "unknownInstrumentType"
      - source-field: "maturity"
        target-field: "unknownInstrumentMaturity"
      - source-field: "issuer"
        target-field: "unknownInstrumentIssuer"
