# APEX Enrichment Patterns Configuration
# External data source configuration for enrichment patterns processing
# Replaces embedded enrichment patterns from CommoditySwapValidationBootstrap

# ============================================================================
# APEX YAML Configuration File
# ============================================================================
# Used by: ORPHANED - No Java test currently uses this file
# Purpose: Enrichment patterns configuration for commodity bootstrap with
#          enrichment patterns, data enhancement strategies, and commodity
#          enrichment processing using APEX enrichment capabilities
# Status: Available for integration with enrichment patterns tests
# ============================================================================

metadata:
  id: "enrichment-patterns-configuration"
  name: "Enrichment Patterns Configuration"
  version: "1.0.0"
  description: "Data-driven enrichment patterns configuration for commodity swap processing"
  type: "external-data-config"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  tags: ["apex-demo", "validation", "commodity-bootstrap", "enrichment-patterns"]

# Enrichment patterns configuration by pattern type
data:
  client-data-enrichment:
    pattern-type: "client-data-enrichment"
    pattern-name: "Client Data Enrichment Pattern"
    description: "Enrich commodity swaps with comprehensive client information"
    enrichment-parameters:
      data-source: "client-database"
      lookup-strategy: "client-id-based"
      caching-enabled: true
      validation-level: "comprehensive"
    enrichment-stages:
      client-reference-lookup:
        stage-name: "Client Reference Data Lookup"
        stage-description: "Lookup client reference data from database"
        processing-steps:
          - step: "connect-to-client-database"
            description: "Connect to client reference database"
            timeout: 500
            connection-pool: "client-pool"
          - step: "lookup-client-details"
            description: "Lookup client details by client ID"
            timeout: 300
            query-type: "client-lookup"
          - step: "validate-client-status"
            description: "Validate client status and eligibility"
            timeout: 200
            validation-rules: ["active-status", "trading-eligibility"]
        stage-timeout: 1000
        
      client-risk-assessment:
        stage-name: "Client Risk Assessment"
        stage-description: "Assess client risk profile and limits"
        processing-steps:
          - step: "lookup-risk-profile"
            description: "Lookup client risk profile"
            timeout: 400
            risk-categories: ["credit-risk", "market-risk", "operational-risk"]
          - step: "check-exposure-limits"
            description: "Check current exposure against limits"
            timeout: 300
            limit-types: ["single-name", "sector", "commodity"]
          - step: "calculate-available-capacity"
            description: "Calculate available trading capacity"
            timeout: 200
            capacity-factors: ["credit-limit", "risk-appetite", "regulatory-limits"]
        stage-timeout: 900
        
      client-preferences-enrichment:
        stage-name: "Client Preferences Enrichment"
        stage-description: "Enrich with client trading preferences"
        processing-steps:
          - step: "lookup-trading-preferences"
            description: "Lookup client trading preferences"
            timeout: 200
            preference-categories: ["commodity-types", "settlement-preferences", "reporting-requirements"]
          - step: "apply-client-constraints"
            description: "Apply client-specific constraints"
            timeout: 150
            constraint-types: ["commodity-restrictions", "notional-limits", "maturity-constraints"]
        stage-timeout: 350
    pattern-settings:
      total-timeout: 2250
      parallel-stages: true
      error-handling: "continue-on-warning"
      result-caching: true
    
  commodity-reference-enrichment:
    pattern-type: "commodity-reference-enrichment"
    pattern-name: "Commodity Reference Data Enrichment Pattern"
    description: "Enrich commodity swaps with comprehensive commodity reference data"
    enrichment-parameters:
      data-source: "commodity-reference-database"
      lookup-strategy: "commodity-type-based"
      caching-enabled: true
      validation-level: "comprehensive"
    enrichment-stages:
      commodity-specification-lookup:
        stage-name: "Commodity Specification Lookup"
        stage-description: "Lookup commodity specifications and characteristics"
        processing-steps:
          - step: "lookup-commodity-details"
            description: "Lookup commodity details by type"
            timeout: 400
            lookup-fields: ["name", "category", "exchange", "contract-specifications"]
          - step: "validate-commodity-specifications"
            description: "Validate commodity specifications"
            timeout: 300
            validation-aspects: ["exchange-listing", "contract-size", "delivery-specifications"]
          - step: "enrich-market-conventions"
            description: "Enrich with market conventions"
            timeout: 200
            convention-types: ["pricing-conventions", "settlement-conventions", "calendar-conventions"]
        stage-timeout: 900
        
      commodity-pricing-enrichment:
        stage-name: "Commodity Pricing Enrichment"
        stage-description: "Enrich with current commodity pricing data"
        processing-steps:
          - step: "lookup-current-prices"
            description: "Lookup current commodity prices"
            timeout: 500
            price-sources: ["exchange-data", "market-data-vendors", "internal-pricing"]
          - step: "calculate-price-metrics"
            description: "Calculate price-related metrics"
            timeout: 400
            metrics: ["volatility", "correlation", "basis", "convenience-yield"]
          - step: "assess-price-quality"
            description: "Assess price data quality"
            timeout: 200
            quality-checks: ["staleness", "outliers", "completeness"]
        stage-timeout: 1100
        
      commodity-risk-enrichment:
        stage-name: "Commodity Risk Enrichment"
        stage-description: "Enrich with commodity-specific risk factors"
        processing-steps:
          - step: "assess-commodity-volatility"
            description: "Assess commodity price volatility"
            timeout: 300
            volatility-models: ["historical", "implied", "garch"]
          - step: "assess-liquidity-risk"
            description: "Assess commodity market liquidity"
            timeout: 250
            liquidity-metrics: ["bid-ask-spread", "market-depth", "trading-volume"]
          - step: "assess-storage-costs"
            description: "Assess storage and carrying costs"
            timeout: 200
            cost-components: ["storage", "insurance", "financing", "convenience-yield"]
        stage-timeout: 750
    pattern-settings:
      total-timeout: 2750
      parallel-stages: false
      error-handling: "fail-on-critical-error"
      result-caching: true
    
  market-data-integration:
    pattern-type: "market-data-integration"
    pattern-name: "Market Data Integration Pattern"
    description: "Integrate real-time and historical market data"
    enrichment-parameters:
      data-source: "market-data-feeds"
      lookup-strategy: "real-time"
      caching-enabled: false
      validation-level: "real-time"
    enrichment-stages:
      real-time-data-integration:
        stage-name: "Real-Time Market Data Integration"
        stage-description: "Integrate real-time market data feeds"
        processing-steps:
          - step: "connect-to-market-feeds"
            description: "Connect to real-time market data feeds"
            timeout: 600
            feed-providers: ["bloomberg", "refinitiv", "exchange-direct"]
          - step: "subscribe-to-instruments"
            description: "Subscribe to relevant commodity instruments"
            timeout: 400
            subscription-types: ["spot-prices", "futures-curves", "volatility-surfaces"]
          - step: "validate-data-quality"
            description: "Validate real-time data quality"
            timeout: 300
            quality-checks: ["latency", "completeness", "consistency"]
        stage-timeout: 1300
        
      historical-data-integration:
        stage-name: "Historical Market Data Integration"
        stage-description: "Integrate historical market data for analysis"
        processing-steps:
          - step: "retrieve-historical-prices"
            description: "Retrieve historical price data"
            timeout: 800
            history-periods: ["1-month", "3-months", "1-year", "5-years"]
          - step: "calculate-historical-metrics"
            description: "Calculate historical risk metrics"
            timeout: 600
            metrics: ["volatility", "correlation", "var", "expected-shortfall"]
          - step: "perform-statistical-analysis"
            description: "Perform statistical analysis on historical data"
            timeout: 400
            analysis-types: ["trend-analysis", "seasonality", "regime-detection"]
        stage-timeout: 1800
    pattern-settings:
      total-timeout: 3100
      parallel-stages: true
      error-handling: "fail-on-error"
      result-caching: false
    
  regulatory-compliance-enrichment:
    pattern-type: "regulatory-compliance-enrichment"
    pattern-name: "Regulatory Compliance Enrichment Pattern"
    description: "Enrich with regulatory compliance information"
    enrichment-parameters:
      data-source: "regulatory-database"
      lookup-strategy: "jurisdiction-based"
      caching-enabled: true
      validation-level: "comprehensive"
    enrichment-stages:
      regulatory-requirements-lookup:
        stage-name: "Regulatory Requirements Lookup"
        stage-description: "Lookup applicable regulatory requirements"
        processing-steps:
          - step: "identify-applicable-regulations"
            description: "Identify applicable regulatory regimes"
            timeout: 400
            regimes: ["DODD_FRANK", "EMIR", "CFTC", "MiFID_II"]
          - step: "lookup-specific-requirements"
            description: "Lookup specific regulatory requirements"
            timeout: 500
            requirement-types: ["reporting", "clearing", "margining", "position-limits"]
          - step: "assess-compliance-status"
            description: "Assess current compliance status"
            timeout: 300
            compliance-checks: ["entity-registration", "documentation", "reporting-status"]
        stage-timeout: 1200
        
      compliance-validation:
        stage-name: "Compliance Validation"
        stage-description: "Validate compliance with regulatory requirements"
        processing-steps:
          - step: "validate-position-limits"
            description: "Validate against position limits"
            timeout: 300
            limit-types: ["speculative-limits", "hedge-exemptions", "large-trader-thresholds"]
          - step: "validate-reporting-requirements"
            description: "Validate reporting requirements"
            timeout: 250
            reporting-types: ["trade-reporting", "position-reporting", "large-trader-reporting"]
          - step: "validate-documentation"
            description: "Validate required documentation"
            timeout: 200
            document-types: ["ISDA", "CSA", "regulatory-agreements"]
        stage-timeout: 750
    pattern-settings:
      total-timeout: 1950
      parallel-stages: false
      error-handling: "fail-on-critical-error"
      result-caching: true
    
  default:
    pattern-type: "default"
    pattern-name: "Default Enrichment Pattern"
    description: "Default enrichment processing"
    enrichment-stages:
      basic-enrichment:
        stage-name: "Basic Enrichment"
        stage-description: "Basic enrichment processing"
        processing-steps:
          - step: "basic-data-lookup"
            description: "Basic data lookup"
            timeout: 500
        stage-timeout: 500
    pattern-settings:
      total-timeout: 500

# Enrichment algorithms
enrichment-algorithms:
  client-id-based-lookup:
    algorithm-name: "Client ID Based Lookup"
    description: "Lookup client data using client ID"
    characteristics:
      - "Direct client ID matching"
      - "Comprehensive client profile retrieval"
      - "Risk profile integration"
    
  commodity-type-based-lookup:
    algorithm-name: "Commodity Type Based Lookup"
    description: "Lookup commodity data using commodity type"
    characteristics:
      - "Commodity specification retrieval"
      - "Market convention integration"
      - "Pricing data integration"
    
  real-time-integration:
    algorithm-name: "Real-Time Data Integration"
    description: "Integrate real-time market data"
    characteristics:
      - "Low-latency data access"
      - "Quality validation"
      - "Streaming data processing"

# Data source mappings
data-source-mappings:
  client-database:
    source-type: "database"
    connection-string: "jdbc:postgresql://localhost:5432/client_data"
    schema: "client_reference"
    primary-tables: ["clients", "risk_profiles", "trading_limits"]
    
  commodity-reference-database:
    source-type: "database"
    connection-string: "jdbc:postgresql://localhost:5432/commodity_reference"
    schema: "commodity_data"
    primary-tables: ["commodities", "specifications", "market_conventions"]
    
  market-data-feeds:
    source-type: "external-api"
    providers: ["bloomberg-api", "refinitiv-eikon", "exchange-direct"]
    authentication: "api-key"
    rate-limits: "1000-requests-per-minute"

# Quality assurance
quality-assurance:
  enrichment-accuracy:
    - "Enrichment data must be accurate and current"
    - "Data sources must be reliable"
    - "Quality validation must be comprehensive"
    - "Error handling must be robust"
    
  performance-requirements:
    - "Enrichment time must be within SLA"
    - "Data source connections must be efficient"
    - "Caching must improve performance"
    - "Parallel processing must be thread-safe"
    
  data-quality:
    - "Data completeness must be validated"
    - "Data consistency must be maintained"
    - "Data freshness must be monitored"
    - "Data lineage must be tracked"
