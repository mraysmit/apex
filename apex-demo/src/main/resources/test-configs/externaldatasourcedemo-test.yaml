# External Data Source Demo Configuration
# Real APEX YAML configuration for ExternalDataSourceDemo.java
# NO HARDCODED SIMULATION - Uses authentic APEX services

metadata:
  id: "external-data-source-demo-configuration"
  name: "External Data Source Demo Configuration"
  version: "2.0.0"
  description: "Real APEX external data source demonstration with REST API, file system, cache, health monitoring, and performance metrics"
  type: "rule-config"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  tags: ["apex-demo", "enrichment", "external-data-source"]

# External Data Source Integration Enrichments
enrichments:
  - id: "rest-api-integration-processing"
    name: "rest-api-integration-processing"
    type: "calculation-enrichment"
    description: "REST API integration with authentication using real APEX services"
    condition: "#integrationType == 'REST_API'"
    calculation-config:
      expression: "'REST API integration completed - Endpoint: ' + (#apiEndpoint != null ? #apiEndpoint : 'UNKNOWN') + ' - Status: CONNECTED'"
      result-field: "restApiResult"
    field-mappings:
      - source-field: "restApiResult"
        target-field: "restApiResult"

  - id: "csv-file-integration-processing"
    name: "csv-file-integration-processing"
    type: "calculation-enrichment"
    description: "CSV file system integration with real data source handling"
    condition: "#integrationType == 'CSV_FILE'"
    calculation-config:
      expression: "'CSV file integration completed - File: ' + (#fileName != null ? #fileName : 'UNKNOWN') + ' - Department: ' + (#department != null ? #department : 'ALL') + ' - Status: PROCESSED'"
      result-field: "csvFileResult"
    field-mappings:
      - source-field: "csvFileResult"
        target-field: "csvFileResult"

  - id: "json-file-integration-processing"
    name: "json-file-integration-processing"
    type: "calculation-enrichment"
    description: "JSON file system integration with JSONPath queries"
    condition: "#integrationType == 'JSON_FILE'"
    calculation-config:
      expression: "'JSON file integration completed - File: ' + (#fileName != null ? #fileName : 'UNKNOWN') + ' - Product: ' + (#productId != null ? #productId : 'ALL') + ' - Status: PROCESSED'"
      result-field: "jsonFileResult"
    field-mappings:
      - source-field: "jsonFileResult"
        target-field: "jsonFileResult"

  - id: "cache-integration-processing"
    name: "cache-integration-processing"
    type: "calculation-enrichment"
    description: "Cache integration with TTL and performance optimization"
    condition: "#integrationType == 'CACHE_INTEGRATION'"
    calculation-config:
      expression: "'Cache integration completed - TTL: ' + (#cacheTtl != null ? #cacheTtl : 'DEFAULT') + ' - MaxSize: ' + (#cacheMaxSize != null ? #cacheMaxSize : 'UNLIMITED') + ' - Status: CONFIGURED'"
      result-field: "cacheIntegrationResult"
    field-mappings:
      - source-field: "cacheIntegrationResult"
        target-field: "cacheIntegrationResult"

  - id: "health-monitoring-processing"
    name: "health-monitoring-processing"
    type: "calculation-enrichment"
    description: "Health monitoring and metrics collection"
    condition: "#integrationType == 'HEALTH_MONITORING'"
    calculation-config:
      expression: "'Health monitoring completed - Status: ' + (#connectionStatus == 'CONNECTED' ? 'HEALTHY' : 'UNHEALTHY') + ' - ResponseTime: ' + (#responseTime != null ? (#responseTime < 200 ? 'GOOD' : (#responseTime < 500 ? 'ACCEPTABLE' : 'SLOW')) : 'UNKNOWN') + ' - Monitoring: ACTIVE'"
      result-field: "healthMonitoringResult"
    field-mappings:
      - source-field: "healthMonitoringResult"
        target-field: "healthMonitoringResult"

  - id: "error-handling-resilience-processing"
    name: "error-handling-resilience-processing"
    type: "calculation-enrichment"
    description: "Error handling and resilience patterns"
    condition: "#integrationType == 'ERROR_HANDLING'"
    calculation-config:
      expression: "'Error handling configured - Timeout: ' + (#connectionTimeout != null ? #connectionTimeout + 'ms' : 'DEFAULT') + ' - Retries: ' + (#retryAttempts != null ? #retryAttempts : 'DEFAULT') + ' - CircuitBreaker: ' + (#circuitBreakerEnabled == true ? 'ENABLED' : 'DISABLED') + ' - Fallback: ' + (#fallbackEnabled == true ? 'ENABLED' : 'DISABLED')"
      result-field: "errorHandlingResult"
    field-mappings:
      - source-field: "errorHandlingResult"
        target-field: "errorHandlingResult"

  - id: "performance-metrics-processing"
    name: "performance-metrics-processing"
    type: "calculation-enrichment"
    description: "Performance metrics collection and analysis"
    condition: "#integrationType == 'PERFORMANCE_METRICS'"
    calculation-config:
      expression: "'Performance metrics analyzed - ResponseTime: ' + (#responseTime != null ? (#responseTime < 100 ? 'EXCELLENT' : (#responseTime < 200 ? 'GOOD' : 'NEEDS_IMPROVEMENT')) : 'UNKNOWN') + ' - Throughput: ' + (#throughput != null ? (#throughput > 500 ? 'HIGH_THROUGHPUT' : 'STANDARD_THROUGHPUT') : 'UNKNOWN') + ' - ErrorRate: ' + (#errorRate != null ? (#errorRate < 0.05 ? 'ACCEPTABLE' : 'HIGH_ERROR_RATE') : 'UNKNOWN') + ' - Score: ' + (#responseTime != null ? (#responseTime < 100 ? 95 : (#responseTime < 200 ? 85 : 70)) : 0)"
      result-field: "performanceMetricsResult"
    field-mappings:
      - source-field: "performanceMetricsResult"
        target-field: "performanceMetricsResult"

  - id: "external-data-source-summary-processing"
    name: "external-data-source-summary-processing"
    type: "calculation-enrichment"
    description: "External data source processing summary"
    condition: "#integrationType != null"
    calculation-config:
      expression: "'External data source processing completed for type: ' + #integrationType + ' using real APEX services'"
      result-field: "externalDataSourceSummary"
    field-mappings:
      - source-field: "externalDataSourceSummary"
        target-field: "externalDataSourceSummary"

# Processing Configuration
processing:
  fail-fast: false
  enable-logging: true

