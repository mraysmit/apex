# APEX Compliance Rules Configuration
# External data source configuration for compliance rules
# Replaces hardcoded rule creation from ComplianceServiceDemo

type: "external-data-config"
name: "compliance-rules"
description: "Compliance rules for regulatory reporting requirements"

# Compliance rules by regulation
data:
  MiFID_II:
    rule-id: "MiFIDReportingRule"
    description: "Trade requires MiFID II reporting"
    condition: "#data.tradeType != null && #data.applicableRegulations != null && #data.applicableRegulations.contains('MiFID II')"
    message: "Trade requires MiFID II reporting"
    severity: "MANDATORY"
    deadline-hours: 24
    
  EMIR:
    rule-id: "EMIRReportingRule"
    description: "Trade requires EMIR reporting"
    condition: "#data.tradeType != null && #data.applicableRegulations != null && #data.applicableRegulations.contains('EMIR')"
    message: "Trade requires EMIR reporting"
    severity: "MANDATORY"
    deadline-hours: 48
    
  DODD_FRANK:
    rule-id: "DoddFrankReportingRule"
    description: "Trade requires Dodd-Frank reporting"
    condition: "#data.tradeType != null && #data.applicableRegulations != null && #data.applicableRegulations.contains('Dodd-Frank')"
    message: "Trade requires Dodd-Frank reporting"
    severity: "MANDATORY"
    deadline-hours: 72
    
  BASEL_III:
    rule-id: "BaselReportingRule"
    description: "Trade requires Basel III reporting"
    condition: "#data.tradeType != null && #data.applicableRegulations != null && #data.applicableRegulations.contains('Basel III')"
    message: "Trade requires Basel III reporting"
    severity: "MANDATORY"
    deadline-hours: 168
    
  SFTR:
    rule-id: "SFTRReportingRule"
    description: "Trade requires SFTR reporting"
    condition: "#data.tradeType != null && #data.applicableRegulations != null && #data.applicableRegulations.contains('SFTR')"
    message: "Trade requires SFTR reporting"
    severity: "MANDATORY"
    deadline-hours: 24

# Compliance validation rules
validation-rules:
  trade-completeness:
    rule-id: "TradeCompletenessRule"
    description: "Validate trade data completeness"
    condition: "#data.tradeId != null && !#data.tradeId.isEmpty() && #data.tradeType != null && !#data.tradeType.isEmpty() && #data.category != null && !#data.category.isEmpty()"
    message: "Trade data is complete"
    failure-message: "Trade data is incomplete - missing required fields"
    severity: "CRITICAL"
    
  risk-assessment:
    rule-id: "RiskAssessmentRule"
    description: "Validate risk assessment requirements"
    condition: "#data.riskLevel != null && !#data.riskLevel.equals('High') && !#data.riskLevel.equals('Extreme')"
    message: "Risk assessment passed"
    failure-message: "Trade has high or extreme risk level requiring additional compliance checks"
    severity: "WARNING"

# Report generation templates
report-templates:
  MiFID_II:
    template-id: "MiFID_II_Report"
    title: "MiFID II Transaction Report"
    sections:
      - field: "tradeId"
        label: "Trade ID"
      - field: "tradeType"
        label: "Instrument Type"
      - field: "category"
        label: "Category"
      - field: "reportingDeadline"
        label: "Reporting Deadline"
        suffix: " hours"
    
  EMIR:
    template-id: "EMIR_Report"
    title: "EMIR Transaction Report"
    sections:
      - field: "tradeId"
        label: "Trade ID"
      - field: "tradeType"
        label: "Instrument Type"
      - field: "category"
        label: "Category"
      - field: "reportingDeadline"
        label: "Reporting Deadline"
        suffix: " hours"
    
  DODD_FRANK:
    template-id: "DoddFrank_Report"
    title: "Dodd-Frank Transaction Report"
    sections:
      - field: "tradeId"
        label: "Trade ID"
      - field: "tradeType"
        label: "Instrument Type"
      - field: "category"
        label: "Category"
      - field: "reportingDeadline"
        label: "Reporting Deadline"
        suffix: " hours"
    
  BASEL_III:
    template-id: "Basel_Report"
    title: "Basel III Transaction Report"
    sections:
      - field: "tradeId"
        label: "Trade ID"
      - field: "tradeType"
        label: "Instrument Type"
      - field: "category"
        label: "Category"
      - field: "reportingDeadline"
        label: "Reporting Deadline"
        suffix: " hours"
    
  SFTR:
    template-id: "SFTR_Report"
    title: "SFTR Transaction Report"
    sections:
      - field: "tradeId"
        label: "Trade ID"
      - field: "tradeType"
        label: "Instrument Type"
      - field: "category"
        label: "Category"
      - field: "reportingDeadline"
        label: "Reporting Deadline"
        suffix: " hours"
