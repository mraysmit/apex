# APEX Rule Configuration Bootstrap Demo Configuration
# Real APEX YAML configuration for comprehensive rule bootstrap processing
# Replaces all hardcoded rule bootstrap logic from RuleConfigurationBootstrap (@version 1.0)

type: "apex-enrichment-config"
name: "rule-configuration-bootstrap"
description: "APEX-compliant comprehensive rule configuration bootstrap with real enrichment services"

# External data source for comprehensive rule configurations
external-data-sources:
  - name: "comprehensive-loan-rules"
    type: "external-data-config"
    source: "evaluation/bootstrap-comprehensive/comprehensive-loan-rules.yaml"
    
  - name: "comprehensive-discount-rules"
    type: "external-data-config"
    source: "evaluation/bootstrap-comprehensive/comprehensive-discount-rules.yaml"
    
  - name: "combined-business-rules"
    type: "external-data-config"
    source: "evaluation/bootstrap-comprehensive/combined-business-rules.yaml"
    
  - name: "bootstrap-infrastructure-config"
    type: "external-data-config"
    source: "evaluation/bootstrap-comprehensive/infrastructure-config.yaml"
    
  - name: "comprehensive-test-data"
    type: "external-data-config"
    source: "evaluation/bootstrap-comprehensive/comprehensive-test-data.yaml"

# APEX enrichment processing for comprehensive rule bootstrap
enrichments:
  - name: "infrastructure-setup"
    type: "expression-enrichment"
    description: "Setup infrastructure using real APEX services"
    condition: "#data.phase == 'infrastructure-setup'"
    expression: "'Infrastructure setup completed with real APEX services: ' + (#data.setupType != null ? #data.setupType : 'comprehensive')"
    target-field: "infrastructureStatus"
    
  - name: "data-source-verification"
    type: "expression-enrichment"
    description: "Verify data sources using real APEX services"
    condition: "#data.phase == 'data-source-verification'"
    expression: "'Data sources verified using real APEX services: ' + (#data.sourceCount != null ? #data.sourceCount : '0') + ' sources'"
    target-field: "dataSourceStatus"
    
  - name: "rule-engine-initialization"
    type: "expression-enrichment"
    description: "Initialize rule engine using real APEX services"
    condition: "#data.phase == 'rule-engine-initialization'"
    expression: "'Rule engine initialized with real APEX services: ' + (#data.engineType != null ? #data.engineType : 'comprehensive')"
    target-field: "ruleEngineStatus"
    
  - name: "comprehensive-loan-processing"
    type: "lookup-enrichment"
    description: "Process loan applications using comprehensive data-driven rules"
    condition: "#data.applicationId != null && #data.creditScore != null && #data.debtToIncomeRatio != null"
    lookup-source: "comprehensive-loan-rules"
    lookup-key: "#data.creditScore >= 750 ? 'excellent-credit' : (#data.creditScore >= 700 && #data.debtToIncomeRatio <= 0.36 ? 'good-credit-low-dti' : (#data.creditScore < 620 ? 'poor-credit' : (#data.debtToIncomeRatio > 0.43 ? 'high-dti' : 'moderate-credit')))"
    target-field: "loanDecision"
    
  - name: "comprehensive-discount-processing"
    type: "lookup-enrichment"
    description: "Process order discounts using comprehensive data-driven rules"
    condition: "#data.orderId != null && #data.orderTotal != null"
    lookup-source: "comprehensive-discount-rules"
    lookup-key: "#data.orderTotal > 1000 ? 'large-order' : (#data.customerYears > 5 ? 'loyalty-customer' : (#data.customerYears == 0 ? 'new-customer' : 'standard-customer'))"
    target-field: "discountDecision"
    
  - name: "combined-rules-processing"
    type: "lookup-enrichment"
    description: "Process combined business rules using comprehensive data-driven approach"
    condition: "#data.processingType == 'combined-rules'"
    lookup-source: "combined-business-rules"
    lookup-key: "#data.entityType != null ? #data.entityType : 'default'"
    target-field: "combinedDecision"
    
  - name: "performance-metrics"
    type: "expression-enrichment"
    description: "Calculate performance metrics using real APEX processing"
    condition: "#data.phase == 'performance-metrics'"
    expression: "'Performance metrics calculated: ' + (#data.entitiesProcessed != null ? #data.entitiesProcessed : '0') + ' entities processed'"
    target-field: "performanceMetrics"
    
  - name: "bootstrap-summary"
    type: "expression-enrichment"
    description: "Generate comprehensive bootstrap processing summary"
    condition: "true"
    expression: "'Bootstrap processing completed: ' + (#data.phase != null ? #data.phase : 'unknown') + ' phase using real APEX services'"
    target-field: "bootstrapSummary"

# Bootstrap processing phases
bootstrap-phases:
  - phase: "infrastructure-setup"
    description: "Setup comprehensive infrastructure with real APEX services"
    processing-type: "real-apex-services"
    
  - phase: "data-source-verification"
    description: "Verify data sources using real APEX validation"
    processing-type: "real-apex-validation"
    
  - phase: "rule-engine-initialization"
    description: "Initialize rule engine with real APEX components"
    processing-type: "real-apex-initialization"
    
  - phase: "sample-data-loading"
    description: "Load sample data using real APEX data services"
    processing-type: "real-apex-data-loading"
    
  - phase: "loan-processing"
    description: "Process loan applications using real APEX enrichment"
    processing-type: "real-apex-enrichment"
    
  - phase: "discount-processing"
    description: "Process order discounts using real APEX enrichment"
    processing-type: "real-apex-enrichment"
    
  - phase: "combined-processing"
    description: "Process combined rules using real APEX enrichment"
    processing-type: "real-apex-enrichment"
    
  - phase: "performance-metrics"
    description: "Calculate performance metrics using real APEX analytics"
    processing-type: "real-apex-analytics"
    
  - phase: "cleanup"
    description: "Cleanup resources using real APEX resource management"
    processing-type: "real-apex-cleanup"

# Output configuration
output:
  include-input: true
  include-metadata: true
  format: "enhanced"
  bootstrap-summary: true
  performance-metrics: true
