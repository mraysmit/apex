# APEX Dynamic Method Execution Demo Configuration
# Real APEX YAML configuration for dynamic method execution processing
# Replaces all hardcoded dynamic method execution logic from DynamicMethodExecutionDemo (@version 1.0)

metadata:
  name: "Dynamic Method Execution Demo"
  version: "1.0.0"
  description: "APEX-compliant dynamic method execution with real enrichment services"
  type: "rule-config"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  tags: ["apex-demo", "evaluation", "dynamic-execution"]

# External data source for dynamic method execution configurations
external-data-sources:
  - name: "settlement-processing-config"
    type: "external-data-config"
    source: "evaluation/dynamic-execution/settlement-processing-config.yaml"
    
  - name: "risk-management-config"
    type: "external-data-config"
    source: "evaluation/dynamic-execution/risk-management-config.yaml"
    
  - name: "pricing-service-config"
    type: "external-data-config"
    source: "evaluation/dynamic-execution/pricing-service-config.yaml"
    
  - name: "compliance-service-config"
    type: "external-data-config"
    source: "evaluation/dynamic-execution/compliance-service-config.yaml"
    
  - name: "dynamic-rules-config"
    type: "external-data-config"
    source: "evaluation/dynamic-execution/dynamic-rules-config.yaml"
    
  - name: "dynamic-test-data"
    type: "external-data-config"
    source: "evaluation/dynamic-execution/dynamic-test-data.yaml"

# APEX enrichment processing for dynamic method execution
enrichments:
  - name: "settlement-days-calculation"
    type: "lookup-enrichment"
    description: "Calculate settlement days using data-driven configuration"
    condition: "#data.tradeType != null && #data.processingType == 'settlement-processing'"
    lookup-source: "settlement-processing-config"
    lookup-key: "#data.tradeType"
    target-field: "settlementDays"
    
  - name: "settlement-method-determination"
    type: "lookup-enrichment"
    description: "Determine settlement method using data-driven configuration"
    condition: "#data.tradeType != null && #data.processingType == 'settlement-processing'"
    lookup-source: "settlement-processing-config"
    lookup-key: "#data.tradeType + '_method'"
    target-field: "settlementMethod"
    
  - name: "market-risk-calculation"
    type: "lookup-enrichment"
    description: "Calculate market risk using data-driven configuration"
    condition: "#data.tradeType != null && #data.processingType == 'risk-management'"
    lookup-source: "risk-management-config"
    lookup-key: "#data.tradeType + '_market_risk'"
    target-field: "marketRisk"
    
  - name: "credit-risk-calculation"
    type: "lookup-enrichment"
    description: "Calculate credit risk using data-driven configuration"
    condition: "#data.tradeType != null && #data.processingType == 'risk-management'"
    lookup-source: "risk-management-config"
    lookup-key: "#data.tradeType + '_credit_risk'"
    target-field: "creditRisk"
    
  - name: "pricing-calculation"
    type: "lookup-enrichment"
    description: "Calculate pricing using data-driven configuration"
    condition: "#data.basePrice != null && #data.processingType == 'pricing-service'"
    lookup-source: "pricing-service-config"
    lookup-key: "#data.pricingType != null ? #data.pricingType : 'standard'"
    target-field: "calculatedPrice"
    
  - name: "compliance-regulations-lookup"
    type: "lookup-enrichment"
    description: "Get applicable regulations using data-driven configuration"
    condition: "#data.tradeType != null && #data.processingType == 'compliance-service'"
    lookup-source: "compliance-service-config"
    lookup-key: "#data.tradeType + '_regulations'"
    target-field: "applicableRegulations"
    
  - name: "dynamic-rule-execution"
    type: "lookup-enrichment"
    description: "Execute dynamic rules using data-driven configuration"
    condition: "#data.ruleName != null && #data.processingType == 'dynamic-rules'"
    lookup-source: "dynamic-rules-config"
    lookup-key: "#data.ruleName"
    target-field: "ruleResult"
    
  - name: "conditional-processing"
    type: "expression-enrichment"
    description: "Process conditional logic using real APEX expressions"
    condition: "#data.processingType == 'conditional-processing'"
    expression: "#data.condition != null && #data.condition ? #data.trueValue : #data.falseValue"
    target-field: "conditionalResult"
    
  - name: "fee-calculation"
    type: "expression-enrichment"
    description: "Calculate fees using real APEX expressions"
    condition: "#data.processingType == 'fee-calculation' && #data.notionalValue != null"
    expression: "#data.notionalValue * (#data.feeRate != null ? #data.feeRate : 0.001)"
    target-field: "calculatedFee"
    
  - name: "dynamic-execution-summary"
    type: "expression-enrichment"
    description: "Generate dynamic method execution summary"
    condition: "true"
    expression: "'Dynamic method execution completed: ' + (#data.processingType != null ? #data.processingType : 'unknown') + ' using real APEX services'"
    target-field: "executionSummary"

# Dynamic method execution categories
execution-categories:
  - category: "settlement-processing"
    description: "Settlement days calculation and method determination"
    processing-type: "real-apex-enrichment"
    
  - category: "risk-management"
    description: "Market risk and credit risk calculations"
    processing-type: "real-apex-enrichment"
    
  - category: "pricing-service"
    description: "Standard, premium, sale, and clearance pricing"
    processing-type: "real-apex-enrichment"
    
  - category: "compliance-service"
    description: "Regulatory compliance and applicable regulations"
    processing-type: "real-apex-enrichment"
    
  - category: "dynamic-rules"
    description: "Dynamic rule execution and evaluation"
    processing-type: "real-apex-enrichment"
    
  - category: "conditional-processing"
    description: "Conditional logic and decision processing"
    processing-type: "real-apex-expressions"
    
  - category: "fee-calculation"
    description: "Fee and commission calculations"
    processing-type: "real-apex-expressions"

# Output configuration
output:
  include-input: true
  include-metadata: true
  format: "enhanced"
  execution-summary: true
  performance-metrics: true
