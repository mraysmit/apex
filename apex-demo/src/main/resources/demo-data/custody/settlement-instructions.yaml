# Custody Auto-Repair Demo - Settlement Instructions Data
# This file contains sample settlement instruction data for the Custody demonstration
# Business users can modify this data to test different scenarios

metadata:
  version: "1.0"
  description: "Sample settlement instruction data for Custody demonstrations"
  lastUpdated: "2025-07-28"
  author: "APEX Demo Team"

# Configuration for settlement instruction validation
configuration:
  validation:
    minSettlementAmount: 1000.0
    maxSettlementAmount: 100000000.0
    highValueThreshold: 10000000.0
    validMarkets: ["JAPAN", "HONG_KONG", "SINGAPORE", "KOREA", "TAIWAN", "AUSTRALIA"]
    validInstrumentTypes: ["EQUITY", "FIXED_INCOME", "DERIVATIVE", "COMMODITY"]
    validCurrencies: ["JPY", "HKD", "SGD", "KRW", "TWD", "AUD", "USD", "EUR"]
    validSettlementMethods: ["DVP", "DVP_PREMIUM", "FOP", "RVP"]
    requiredFields: ["instructionId", "clientId", "market", "instrumentType", "settlementAmount", "settlementCurrency"]
  
  business-rules:
    autoRepairEnabled: true
    clientOptOutRespected: true
    highValueManualReview: true
    requireApprovalForHighRisk: true
    auditAllDecisions: true

# Sample settlement instructions for demonstrations
settlementInstructions:
  # Basic incomplete instruction - missing counterparty
  - instructionId: "SI001"
    clientId: "CLIENT_A"
    market: "JAPAN"
    instrumentType: "EQUITY"
    settlementAmount: 1000000.0
    settlementCurrency: "JPY"
    settlementDate: "2025-07-30"
    instrumentId: "JP3633400001"
    isin: "JP3633400001"
    deliveryInstruction: "DELIVER"
    missingFields: ["counterpartyId"]
    description: "Basic incomplete instruction for testing auto-repair"
    
  # Premium client instruction - missing settlement method
  - instructionId: "SI002"
    clientId: "PREMIUM_CLIENT_X"
    market: "HONG_KONG"
    instrumentType: "FIXED_INCOME"
    settlementAmount: 5000000.0
    settlementCurrency: "HKD"
    settlementDate: "2025-07-29"
    counterpartyId: "CP_HK_001"
    custodianId: "CUST_HK_PREMIUM"
    missingFields: ["settlementMethod"]
    description: "Premium client instruction with specific requirements"
    
  # Market-specific instructions for Asian markets
  - instructionId: "SI_JAPAN_EQUITY"
    clientId: "CLIENT_GENERIC"
    market: "JAPAN"
    instrumentType: "EQUITY"
    settlementAmount: 2000000.0
    settlementCurrency: "JPY"
    settlementDate: "2025-07-30"
    missingFields: ["custodianId"]
    description: "Japan market equity instruction"
    
  - instructionId: "SI_HONG_KONG_EQUITY"
    clientId: "CLIENT_GENERIC"
    market: "HONG_KONG"
    instrumentType: "EQUITY"
    settlementAmount: 2000000.0
    settlementCurrency: "HKD"
    settlementDate: "2025-07-30"
    missingFields: ["custodianId"]
    description: "Hong Kong market equity instruction"
    
  - instructionId: "SI_SINGAPORE_EQUITY"
    clientId: "CLIENT_GENERIC"
    market: "SINGAPORE"
    instrumentType: "EQUITY"
    settlementAmount: 2000000.0
    settlementCurrency: "SGD"
    settlementDate: "2025-07-30"
    missingFields: ["custodianId"]
    description: "Singapore market equity instruction"
    
  - instructionId: "SI_KOREA_EQUITY"
    clientId: "CLIENT_GENERIC"
    market: "KOREA"
    instrumentType: "EQUITY"
    settlementAmount: 2000000.0
    settlementCurrency: "KRW"
    settlementDate: "2025-07-30"
    missingFields: ["custodianId"]
    description: "Korea market equity instruction"
    
  # High value instruction
  - instructionId: "SI_HIGH_VALUE"
    clientId: "CLIENT_B"
    market: "SINGAPORE"
    instrumentType: "EQUITY"
    settlementAmount: 50000000.0
    settlementCurrency: "SGD"
    settlementDate: "2025-07-31"
    highValueTransaction: true
    missingFields: ["counterpartyId", "custodianId"]
    description: "High value transaction requiring special handling"
    
  # Client opt-out instruction
  - instructionId: "SI_OPT_OUT"
    clientId: "CLIENT_OPT_OUT"
    market: "KOREA"
    instrumentType: "EQUITY"
    settlementAmount: 3000000.0
    settlementCurrency: "KRW"
    settlementDate: "2025-07-30"
    clientOptOut: true
    missingFields: ["counterpartyId"]
    description: "Client has opted out of auto-repair"

# Market currency mappings
marketCurrencies:
  JAPAN: "JPY"
  HONG_KONG: "HKD"
  SINGAPORE: "SGD"
  KOREA: "KRW"
  TAIWAN: "TWD"
  AUSTRALIA: "AUD"

# Client reference data
clients:
  - clientId: "CLIENT_A"
    clientName: "Standard Client A"
    clientType: "INSTITUTIONAL"
    tier: "STANDARD"
    region: "ASIA_PACIFIC"
    autoRepairEnabled: true
    
  - clientId: "PREMIUM_CLIENT_X"
    clientName: "Premium Client X"
    clientType: "INSTITUTIONAL"
    tier: "PREMIUM"
    region: "ASIA_PACIFIC"
    autoRepairEnabled: true
    specialRequirements: true
    
  - clientId: "CLIENT_B"
    clientName: "High Value Client B"
    clientType: "INSTITUTIONAL"
    tier: "PREMIUM"
    region: "ASIA_PACIFIC"
    autoRepairEnabled: true
    highValueClient: true
    
  - clientId: "CLIENT_GENERIC"
    clientName: "Generic Test Client"
    clientType: "INSTITUTIONAL"
    tier: "STANDARD"
    region: "ASIA_PACIFIC"
    autoRepairEnabled: true
    
  - clientId: "CLIENT_OPT_OUT"
    clientName: "Opt-Out Client"
    clientType: "INSTITUTIONAL"
    tier: "STANDARD"
    region: "ASIA_PACIFIC"
    autoRepairEnabled: false
    optedOut: true

# Counterparty reference data
counterparties:
  - counterpartyId: "CP_CLIENT_A_DEFAULT"
    counterpartyName: "Client A Default Counterparty"
    bic: "CLIENTACP01"
    jurisdiction: "JAPAN"
    
  - counterpartyId: "CP_HK_001"
    counterpartyName: "Hong Kong Counterparty 001"
    bic: "HKCOUNTERP1"
    jurisdiction: "HONG_KONG"
    
  - counterpartyId: "CP_JAPAN_STANDARD"
    counterpartyName: "Japan Standard Counterparty"
    bic: "JPSTDCP0001"
    jurisdiction: "JAPAN"
    
  - counterpartyId: "CP_HK_STANDARD"
    counterpartyName: "Hong Kong Standard Counterparty"
    bic: "HKSTDCP0001"
    jurisdiction: "HONG_KONG"
    
  - counterpartyId: "CP_SG_STANDARD"
    counterpartyName: "Singapore Standard Counterparty"
    bic: "SGSTDCP0001"
    jurisdiction: "SINGAPORE"
    
  - counterpartyId: "CP_KR_STANDARD"
    counterpartyName: "Korea Standard Counterparty"
    bic: "KRSTDCP0001"
    jurisdiction: "KOREA"

# Custodian reference data
custodians:
  - custodianId: "CUST_CLIENT_A"
    custodianName: "Client A Custodian"
    bic: "CLIENTACUST"
    jurisdiction: "JAPAN"
    
  - custodianId: "CUST_HK_PREMIUM"
    custodianName: "Hong Kong Premium Custodian"
    bic: "HKPREMCUST1"
    jurisdiction: "HONG_KONG"
    
  - custodianId: "CUST_PREMIUM_GLOBAL"
    custodianName: "Premium Global Custodian Ltd"
    bic: "PREMGBCUST01"
    jurisdiction: "GLOBAL"
    
  - custodianId: "CUST_JAPAN_DEFAULT"
    custodianName: "Japan Default Custodian"
    bic: "JPDEFCUST01"
    jurisdiction: "JAPAN"
    
  - custodianId: "CUST_HK_STANDARD"
    custodianName: "Hong Kong Standard Custodian"
    bic: "HKSTDCUST01"
    jurisdiction: "HONG_KONG"
    
  - custodianId: "CUST_SG_STANDARD"
    custodianName: "Singapore Standard Custodian"
    bic: "SGSTDCUST01"
    jurisdiction: "SINGAPORE"
    
  - custodianId: "CUST_KR_STANDARD"
    custodianName: "Korea Standard Custodian"
    bic: "KRSTDCUST01"
    jurisdiction: "KOREA"

# Test scenarios for different repair outcomes
test-scenarios:
  basic-repair:
    description: "Basic auto-repair scenarios"
    instructions: ["SI001", "SI002"]
    expectedResult: "REPAIRED"
    
  market-specific:
    description: "Market-specific repair scenarios"
    instructions: ["SI_JAPAN_EQUITY", "SI_HONG_KONG_EQUITY", "SI_SINGAPORE_EQUITY", "SI_KOREA_EQUITY"]
    expectedResult: "REPAIRED"
    
  high-value:
    description: "High value transaction handling"
    instructions: ["SI_HIGH_VALUE"]
    expectedResult: "REQUIRES_APPROVAL"
    
  opt-out:
    description: "Client opt-out scenarios"
    instructions: ["SI_OPT_OUT"]
    expectedResult: "NO_REPAIR"

# Business rules for settlement instruction validation
business-rules:
  amount-validation:
    rule: "#settlementAmount != null && #settlementAmount > 0 && #settlementAmount <= 100000000"
    description: "Settlement amount must be positive and within limits"
    errorMessage: "Settlement amount must be between 0 and 100,000,000"
    
  currency-validation:
    rule: "#settlementCurrency != null && #settlementCurrency in {'JPY', 'HKD', 'SGD', 'KRW', 'TWD', 'AUD', 'USD', 'EUR'}"
    description: "Settlement currency must be supported"
    errorMessage: "Settlement currency must be from supported list"
    
  market-validation:
    rule: "#market != null && #market in {'JAPAN', 'HONG_KONG', 'SINGAPORE', 'KOREA', 'TAIWAN', 'AUSTRALIA'}"
    description: "Market must be supported"
    errorMessage: "Market must be from supported list"
    
  high-value-validation:
    rule: "#settlementAmount < 10000000 || #highValueTransaction == true"
    description: "High value transactions must be flagged"
    errorMessage: "Transactions over 10M must be flagged as high value"
    
  client-opt-out-validation:
    rule: "#clientOptOut != true || #autoRepairEnabled == false"
    description: "Respect client opt-out preferences"
    errorMessage: "Auto-repair disabled for opt-out clients"
