# APEX Enrichment Methods Configuration
# External data source configuration for enrichment methods processing
# Replaces hardcoded enrichment logic from OtcOptionsBootstrapDemo

metadata:
  id: "Enrichment Methods Configuration"
  name: "Enrichment Methods Configuration"
  version: "1.0.0"
  description: "Data-driven enrichment methods configuration for OTC options processing"
  type: "external-data-config"
  author: "apex.demo.team@company.com"
  created-date: "2024-12-24"
  tags: ["apex-demo", "enrichment", "enrichment-methods", "external-data"]

# Enrichment methods configuration by method type
data:
  commodity-data-enrichment:
    method-type: "commodity-data-enrichment"
    method-name: "Commodity Data Enrichment"
    description: "Enrich OTC options with comprehensive commodity reference data"
    enrichment-parameters:
      data-source-type: "file-system"
      lookup-strategy: "hierarchical"
      caching-enabled: true
      validation-level: "comprehensive"
    enrichment-stages:
      commodity-reference-lookup:
        stage-name: "Commodity Reference Data Lookup"
        stage-description: "Lookup commodity reference data from file system"
        processing-steps:
          - step: "load-commodity-reference-file"
            description: "Load commodity reference data file"
            timeout: 500
            data-source: "commodity-reference-data.yaml"
          - step: "match-underlying-asset"
            description: "Match underlying asset to reference data"
            timeout: 200
            matching-strategy: "exact-name-match"
          - step: "extract-commodity-attributes"
            description: "Extract commodity attributes and metadata"
            timeout: 300
            attributes: ["exchange", "unit", "category", "sector"]
        stage-timeout: 1000
        
      market-data-enrichment:
        stage-name: "Market Data Enrichment"
        stage-description: "Enrich with current market data"
        processing-steps:
          - step: "lookup-current-price"
            description: "Lookup current market price"
            timeout: 400
            price-source: "market-data-feed"
          - step: "calculate-moneyness"
            description: "Calculate option moneyness"
            timeout: 200
            calculation-method: "strike-vs-spot"
          - step: "assess-volatility"
            description: "Assess implied volatility"
            timeout: 300
            volatility-model: "black-scholes"
        stage-timeout: 900
        
      risk-assessment:
        stage-name: "Risk Assessment"
        stage-description: "Assess commodity-specific risks"
        processing-steps:
          - step: "assess-price-volatility"
            description: "Assess price volatility risk"
            timeout: 300
            volatility-window: "30-days"
          - step: "assess-liquidity-risk"
            description: "Assess market liquidity risk"
            timeout: 200
            liquidity-metrics: ["bid-ask-spread", "volume"]
          - step: "assess-storage-costs"
            description: "Assess storage and carrying costs"
            timeout: 100
            cost-factors: ["storage", "insurance", "financing"]
        stage-timeout: 600
    method-settings:
      total-timeout: 2500
      parallel-stages: false
      error-handling: "continue-on-warning"
      result-caching: true
    
  currency-data-enrichment:
    method-type: "currency-data-enrichment"
    method-name: "Currency Data Enrichment"
    description: "Enrich OTC options with currency and FX data"
    enrichment-parameters:
      data-source-type: "database"
      lookup-strategy: "direct"
      caching-enabled: true
      validation-level: "standard"
    enrichment-stages:
      currency-reference-lookup:
        stage-name: "Currency Reference Data Lookup"
        stage-description: "Lookup currency reference data from database"
        processing-steps:
          - step: "connect-to-currency-database"
            description: "Connect to currency reference database"
            timeout: 300
            connection-pool: "currency-pool"
          - step: "lookup-currency-details"
            description: "Lookup currency details and attributes"
            timeout: 200
            query-type: "currency-lookup"
          - step: "validate-currency-code"
            description: "Validate ISO currency code"
            timeout: 100
            validation-standard: "ISO-4217"
        stage-timeout: 600
        
      fx-rates-enrichment:
        stage-name: "FX Rates Enrichment"
        stage-description: "Enrich with current FX rates"
        processing-steps:
          - step: "lookup-spot-rates"
            description: "Lookup current spot FX rates"
            timeout: 400
            rate-source: "fx-data-feed"
          - step: "lookup-forward-rates"
            description: "Lookup forward FX rates"
            timeout: 300
            forward-tenors: ["1M", "3M", "6M", "1Y"]
          - step: "calculate-fx-risk"
            description: "Calculate FX risk exposure"
            timeout: 200
            risk-model: "delta-equivalent"
        stage-timeout: 900
        
      currency-risk-assessment:
        stage-name: "Currency Risk Assessment"
        stage-description: "Assess currency-specific risks"
        processing-steps:
          - step: "assess-fx-volatility"
            description: "Assess FX volatility risk"
            timeout: 200
            volatility-model: "garch"
          - step: "assess-correlation-risk"
            description: "Assess correlation with underlying"
            timeout: 300
            correlation-window: "1-year"
          - step: "assess-liquidity-risk"
            description: "Assess FX market liquidity"
            timeout: 100
            liquidity-metrics: ["bid-ask-spread", "market-depth"]
        stage-timeout: 600
    method-settings:
      total-timeout: 2100
      parallel-stages: true
      error-handling: "fail-on-error"
      result-caching: true
    
  counterparty-data-enrichment:
    method-type: "counterparty-data-enrichment"
    method-name: "Counterparty Data Enrichment"
    description: "Enrich OTC options with counterparty credit and risk data"
    enrichment-parameters:
      data-source-type: "cache"
      lookup-strategy: "multi-tier"
      caching-enabled: true
      validation-level: "comprehensive"
    enrichment-stages:
      counterparty-reference-lookup:
        stage-name: "Counterparty Reference Data Lookup"
        stage-description: "Lookup counterparty reference data from cache"
        processing-steps:
          - step: "lookup-counterparty-cache"
            description: "Lookup counterparty data from cache"
            timeout: 100
            cache-key-strategy: "counterparty-id"
          - step: "validate-counterparty-data"
            description: "Validate counterparty data completeness"
            timeout: 150
            validation-rules: ["name", "credit-rating", "region"]
          - step: "enrich-counterparty-attributes"
            description: "Enrich with additional counterparty attributes"
            timeout: 200
            attributes: ["sector", "size", "regulatory-status"]
        stage-timeout: 450
        
      credit-rating-enrichment:
        stage-name: "Credit Rating Enrichment"
        stage-description: "Enrich with credit rating and risk data"
        processing-steps:
          - step: "lookup-credit-ratings"
            description: "Lookup current credit ratings"
            timeout: 300
            rating-agencies: ["S&P", "Moody's", "Fitch"]
          - step: "calculate-credit-risk"
            description: "Calculate credit risk metrics"
            timeout: 400
            risk-metrics: ["PD", "LGD", "EAD"]
          - step: "assess-rating-stability"
            description: "Assess credit rating stability"
            timeout: 200
            stability-indicators: ["outlook", "watch-list"]
        stage-timeout: 900
        
      relationship-assessment:
        stage-name: "Relationship Assessment"
        stage-description: "Assess counterparty relationship factors"
        processing-steps:
          - step: "assess-trading-history"
            description: "Assess historical trading relationship"
            timeout: 300
            history-window: "2-years"
          - step: "assess-exposure-limits"
            description: "Assess current exposure against limits"
            timeout: 200
            limit-types: ["single-name", "sector", "geography"]
          - step: "assess-netting-agreements"
            description: "Assess netting and collateral agreements"
            timeout: 150
            agreement-types: ["ISDA", "CSA", "GMRA"]
        stage-timeout: 650
    method-settings:
      total-timeout: 2000
      parallel-stages: true
      error-handling: "continue-on-warning"
      result-caching: true
    
  market-data-integration:
    method-type: "market-data-integration"
    method-name: "Market Data Integration"
    description: "Integrate comprehensive market data for OTC options"
    enrichment-parameters:
      data-source-type: "external-feed"
      lookup-strategy: "real-time"
      caching-enabled: false
      validation-level: "real-time"
    enrichment-stages:
      real-time-data-feed:
        stage-name: "Real-Time Market Data Feed"
        stage-description: "Connect to real-time market data feeds"
        processing-steps:
          - step: "connect-to-market-feed"
            description: "Connect to real-time market data feed"
            timeout: 500
            feed-provider: "bloomberg-api"
          - step: "subscribe-to-instruments"
            description: "Subscribe to relevant instruments"
            timeout: 300
            subscription-type: "real-time"
          - step: "validate-data-quality"
            description: "Validate market data quality"
            timeout: 200
            quality-checks: ["staleness", "outliers", "completeness"]
        stage-timeout: 1000
        
      pricing-model-integration:
        stage-name: "Pricing Model Integration"
        stage-description: "Integrate with pricing models"
        processing-steps:
          - step: "select-pricing-model"
            description: "Select appropriate pricing model"
            timeout: 100
            model-selection-criteria: ["instrument-type", "complexity"]
          - step: "calibrate-model-parameters"
            description: "Calibrate model parameters"
            timeout: 600
            calibration-method: "maximum-likelihood"
          - step: "calculate-theoretical-price"
            description: "Calculate theoretical option price"
            timeout: 400
            pricing-method: "monte-carlo"
        stage-timeout: 1100
    method-settings:
      total-timeout: 2100
      parallel-stages: false
      error-handling: "fail-on-error"
      result-caching: false
    
  default:
    method-type: "default"
    method-name: "Default Enrichment Method"
    description: "Default enrichment processing"
    enrichment-parameters:
      data-source-type: "default"
      lookup-strategy: "basic"
    enrichment-stages:
      basic-enrichment:
        stage-name: "Basic Enrichment"
        stage-description: "Basic enrichment processing"
        processing-steps:
          - step: "basic-validation"
            description: "Basic data validation"
            timeout: 500
        stage-timeout: 500
    method-settings:
      total-timeout: 500

# Enrichment algorithms
enrichment-algorithms:
  hierarchical-lookup:
    algorithm-name: "Hierarchical Data Lookup"
    description: "Lookup data using hierarchical strategy"
    characteristics:
      - "Multi-tier lookup strategy"
      - "Fallback mechanisms"
      - "Performance optimization"
    
  real-time-integration:
    algorithm-name: "Real-Time Data Integration"
    description: "Integrate real-time market data"
    characteristics:
      - "Low-latency data access"
      - "Quality validation"
      - "Streaming data processing"
    
  risk-assessment:
    algorithm-name: "Comprehensive Risk Assessment"
    description: "Assess multiple risk dimensions"
    characteristics:
      - "Multi-factor risk models"
      - "Scenario analysis"
      - "Stress testing"

# Quality assurance
quality-assurance:
  enrichment-accuracy:
    - "Enrichment data must be accurate and current"
    - "Risk calculations must be precise"
    - "Market data must be validated"
    - "Credit ratings must be up-to-date"
    
  performance-requirements:
    - "Enrichment time must be within SLA"
    - "Data source connections must be reliable"
    - "Caching must improve performance"
    - "Parallel processing must be thread-safe"
    
  data-quality:
    - "Data completeness must be validated"
    - "Data consistency must be maintained"
    - "Data freshness must be monitored"
    - "Data lineage must be tracked"
